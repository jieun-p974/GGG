<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="DogamDAO">
	
	<!-- admin list -->
	<select id="getAdminDogam" resultType="dogam">
		SELECT * FROM dogam ORDER BY do_no
	</select>
	
	<!-- admin list with img -->
	<select id="getAdminImgDogam" parameterType="int"  resultType="dogam">
	SELECT DISTINCT d.do_no, d.do_title, d.do_content, a.img1, b.img2, c.img3
	from dogam d, lv_dogam l,
	(SELECT do_img_addr AS img1 FROM lv_dogam WHERE do_lev = 1 AND do_no=#{do_no}) a,
	(SELECT do_img_addr AS img2 FROM lv_dogam WHERE do_lev = 2 AND do_no=#{do_no}) b,
	(SELECT do_img_addr AS img3 FROM lv_dogam WHERE do_lev = 3 AND do_no=#{do_no}) c
	WHERE d.do_no=l.do_no and d.do_no=#{do_no}
	</select>
	
	<!-- dogam list -->
	<select id="getDogamList" resultType="dogam">
	SELECT d.do_no, d.do_title, l.do_lev, l.do_img_addr
	FROM dogam d, lv_dogam l WHERE d.do_no=l.do_no AND l.do_lev=3;
	</select>
	
	<!-- dogam detail -->
 	<select id="getDogam" parameterType="dogam" resultType="dogam">
	SELECT * FROM dogam WHERE do_no=#{do_no}
	</select>

 	<!-- myDogam list -->
<!--	<select id="getMyDogam" parameterType="String" resultType="dogam">
	SELECT a.id, d.do_no, d.do_title, max(l.do_lev) as nowLv, l.do_img_addr, m.do_name, m.do_choice_YN
	FROM dogam d, lv_dogam l, mem_dogam m, member a
	WHERE d.do_no=l.do_no AND l.do_no=m.do_no AND m.id=a.id AND a.id=#{userId} and m.do_choice_YN = "Y"
	</select>
				 -->
				
				
	<!-- dogam insert -->
	<insert id="dogamInsert" parameterType="dogam">
		INSERT INTO dogam (do_title, do_content)
		VALUES (#{do_title}, #{do_content})
	</insert>
		
	<!-- dogam img insert -->
	<insert id="dogamImgInsert" parameterType="dogam">
		INSERT INTO lv_dogam (do_no, do_lev
		<if test='do_img != null'>, do_img, do_img_addr</if>)
	    values (#{do_no}, #{do_lev}
	    <if test='do_img != null'>, #{do_img}, #{do_img_addr}</if>)
	</insert>	
		
	<!-- dogam update -->
	<update id="dogamUpdate" parameterType="dogam">
		UPDATE dogam SET
		do_title=#{do_title}, do_content=#{do_content}
		WHERE do_no = #{do_no}
	</update>
	
	<!-- dogam delete -->
	<delete id="dogamDelete" parameterType="dogam">
		DELETE FROM dogam WHERE do_no = #{do_no}
	</delete>
	
</mapper>