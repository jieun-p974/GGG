<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="member">

	<!-- insert,delete,update는 리턴타입 필요없음 -->

	<!-- 아이디 중복체크 -->
	<select id="idCheck" parameterType="member" resultType="member">
		select * from member where id = #{id}
		<if test="password !=null">
			and password = #{password}
		</if>
	</select>
	
	<!-- 회원가입 -->
	<insert id="memberInsert" parameterType="member">
	    insert into member (id, password, name, tel, email 
	    <if test='m_img != null'>, m_img, m_img_addr</if>)
	    values (#{id}, #{password}, #{name}, #{tel}, #{email}
	    <if test='m_img != null'>, #{m_img}, #{m_img_addr}</if>)
    </insert>
    
	<!-- 회원정보 불러오기 -->
	<select id="memberInfo" parameterType="member" resultType="member">
		select * from member where id = #{id}
	</select>
	
	<!-- 회원정보 수정 -->
	<update id="memberUpdate" parameterType="member"> 
		update member set name=#{name}, password = #{password}, tel = #{tel}
	 <if test='m_img != null'>, m_img = #{m_img}, m_img_addr = #{m_img_addr} </if>
		where id = #{id}
	</update>

	<!-- 로그인 -->
	<select id="login" parameterType="member" resultType="member">
	select id, password FROM member where id=#{id} and password=#{password}
	</select>
	
	<!-- ID찾기 -->
	<select id="searchID" parameterType="String" resultType="String">
	select id FROM member where email=#{email}
	</select>
    
    <!-- PW찾기 -->
	<select id="searchPass" parameterType="String" resultType="String">
	select password FROM member	where email=#{email}
	</select>
	
	<!-- 포인트 사용(기부시) -->
	<update id="goDona" parameterType="hashmap" >
	UPDATE member SET remainder_point = remainder_point - ${givePoint} WHERE id = '${id}'
	</update>
	
</mapper>