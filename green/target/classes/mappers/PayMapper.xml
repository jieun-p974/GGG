<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="payDAO">
	<!-- mem 간편결제수단 select one -->
	<select id="getPay" parameterType="string" resultType="member">
		select m.name as name, a.mem_acc_no, a.acc_num as acc_num, a.bank as bank
		from member m,
		mem_account a
		where m.id=a.id and m.id=#{userId}
	</select>


	<select id="getCPay" parameterType="string" resultType="member">
		select m.name as name, c.mem_card_no, c.card_num as card_num, c.card_company
		as
		card_company, c.expire_date from member m, mem_card c
		where m.id=c.id and m.id=#{userId}
	</select>



	<!--도전권 결제시 cahl_dog_pay 인서트 -->
	<insert id="chalPay" parameterType="hashmap">
		INSERT INTO chal_dog_pay
		(dogeon_no,pay_meth_no,id,last_date,dogeon_pay_date,cash_receipt_YN)
		VALUES(#{dogeon_no},#{pay_meth_no},#{id},(SELECT
		DATE_ADD(NOW(),INTERVAL 30 DAY)),now(),#{cash_receipt_YN})
	</insert>

	<!-- card에 인서트 -->
	<insert id="cardIn" parameterType="hashmap">
		INSERT INTO card
		(dogeon_pay_no,card_num,expiry_date,CVC,card_company,pass_two)
		VALUE(#{dogeon_pay_no},#{card_num},#{expiry_date},#{CVC},#{card_company},#{pass_two})
	</insert>

	<!-- account에 인서트 -->
	<insert id="accIn" parameterType="hashmap">
		INSERT INTO account(dogeon_pay_no,acc_num,bank)
		VALUE(#{dogeon_pay_no},#{acc_num},#{bank})
	</insert>
</mapper>
   